(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery","videojs","imagesloaded","jquery-ui"],e)}else{e(jQuery,videojs)}})(function(e,t){e.BigVideo=function(n){function E(){var t=e(window).width();var n=e(window).height();var r=t/n;if(w.container.is(e("body"))){e("html,body").css("height",e(window).height()>e("body").css("height","auto").height()?"100%":"auto")}if(r<f){if(b==="video"){s.width(n*f).height(n);if(!w.shrinkable){e(o).css("top",0).css("left",-(n*f-t)/2).css("height",n)}else{e(o).css("top",-(t/f-n)/2).css("left",0).css("height",t/f)}e(o+"_html5_api").css("width",n*f).css("height",n);e(o+"_flash_api").css("width",n*f).css("height",n)}else{e("#big-video-image").css({width:"auto",height:n,top:0,left:-(n*f-t)/2})}}else{if(b==="video"){s.width(t).height(t/f);e(o).css("top",-(t/f-n)/2).css("left",0).css("height",t/f);e(o+"_html5_api").css("width",e(o+"_html5_api").parent().width()+"px").css("height","auto");e(o+"_flash_api").css("width",t).css("height",t/f)}else{e("#big-video-image").css({width:t,height:"auto",top:-(t/f-n)/2,left:0})}}}function S(){var t='<div id="big-video-control-container">';t+='<div id="big-video-control">';t+='<a href="#" id="big-video-control-play"></a>';t+='<div id="big-video-control-middle">';t+='<div id="big-video-control-bar">';t+='<div id="big-video-control-bound-left"></div>';t+='<div id="big-video-control-progress"></div>';t+='<div id="big-video-control-track"></div>';t+='<div id="big-video-control-bound-right"></div>';t+="</div>";t+="</div>";t+='<div id="big-video-control-timer"></div>';t+="</div>";t+="</div>";w.container.append(t);e("#big-video-control-container").css("display","none");e("#big-video-control-timer").css("display","none");e("#big-video-control-track").slider({animate:true,step:.01,slide:function(t,n){p=true;e("#big-video-control-progress").css("width",n.value-.16+"%");s.currentTime(n.value/100*s.duration())},stop:function(e,t){p=false;s.currentTime(t.value/100*s.duration())}});e("#big-video-control-bar").click(function(t){s.currentTime(t.offsetX/e(this).width()*s.duration())});e("#big-video-control-play").click(function(e){e.preventDefault();x("toggle")});s.on("timeupdate",function(){if(!p&&s.currentTime()/s.duration()){var t=s.currentTime();var n=Math.floor(t/60);var r=Math.floor(t)-60*n;if(r<10)r="0"+r;var i=s.currentTime()/s.duration()*100;e("#big-video-control-track").slider("value",i);e("#big-video-control-progress").css("width",i-.16+"%");e("#big-video-control-timer").text(n+":"+r+"/"+l)}})}function x(t){var n=t||"toggle";if(n==="toggle")n=d?"pause":"play";if(n==="pause"){s.pause();e("#big-video-control-play").css("background-position","-16px");d=false}else if(n==="play"){s.play();e("#big-video-control-play").css("background-position","0");d=true}else if(n==="skip"){N()}}function T(){s.play();w.container.off("click",T)}function N(){y++;if(y===g.length)y=0;C(g[y])}function C(t){e(o).css("display","block");b="video";s.src(t);d=true;if(m){e("#big-video-control-container").css("display","none");s.ready(function(){s.volume(0)});doLoop=true}else{e("#big-video-control-container").css("display","block");s.ready(function(){s.volume(c)});doLoop=false}e("#big-video-image").css("display","none");e(o).css("display","block")}function k(t){e("#big-video-image").remove();s.pause();e(o).css("display","none");e("#big-video-control-container").css("display","none");b="image";var n=e('<img id="big-video-image" src='+t+" />");u.append(n);e("#big-video-image").imagesLoaded(function(){f=e("#big-video-image").width()/e("#big-video-image").height();E()})}var r={useFlashForFirefox:true,forceAutoplay:false,controls:false,doLoop:false,container:e("body"),shrinkable:false};var i=this,s,o="#big-video-vid",u=e('<div id="big-video-wrap"></div>'),a=e(""),f=16/9,l=0,c=.8,h=false,p=false,d=false,v=false,m=false,g=[],y,b;var w=e.extend({},r,n);i.init=function(){if(!h){w.container.prepend(u);var n=w.forceAutoplay?"autoplay":"";s=e('<video id="'+o.substr(1)+'" class="video-js vjs-default-skin" preload="auto" data-setup="{}" '+n+" webkit-playsinline></video>");s.css("position","absolute");u.append(s);var r=["html5","flash"];var i=navigator.userAgent.toLowerCase();var a=i.indexOf("firefox")!=-1;if(w.useFlashForFirefox&&a){r=["flash","html5"]}s=t(o.substr(1),{controls:false,autoplay:true,preload:"auto",techOrder:r});if(w.controls)S();E();h=true;d=false;if(w.forceAutoplay){e("body").on("click",T)}e("#big-video-vid_flash_api").attr("scale","noborder").attr("width","100%").attr("height","100%");e(window).on("resize.bigvideo",function(){E()});s.on("loadedmetadata",function(t){if(document.getElementById("big-video-vid_flash_api")){f=document.getElementById("big-video-vid_flash_api").vjs_getProperty("videoWidth")/document.getElementById("big-video-vid_flash_api").vjs_getProperty("videoHeight")}else{f=e("#big-video-vid_html5_api").prop("videoWidth")/e("#big-video-vid_html5_api").prop("videoHeight")}E();var n=Math.round(s.duration());var r=Math.floor(n/60);var i=n-r*60;if(i<10)i="0"+i;l=r+":"+i});s.on("ended",function(){if(w.doLoop){s.currentTime(0);s.play()}if(v){N()}})}};i.show=function(e,t){if(t===undefined)t={};m=t.ambient===true;if(m||t.doLoop)w.doLoop=true;if(typeof e==="string"){var n=e.substring(e.lastIndexOf(".")+1);if(n==="jpg"||n==="gif"||n==="png"){k(e)}else{if(t.altSource&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1){e=t.altSource}C(e);if(t.onShown)t.onShown();v=false}}else{g=e;y=0;C(g[y]);if(t.onShown)t.onShown();v=true}};i.getPlayer=function(){return s};i.remove=i.dispose=function(){h=false;u.remove();e(window).off("resize.bigvideo");if(s){s.off("loadedmetadata");s.off("ended");s.dispose()}};i.triggerPlayer=function(e){x(e)}}})